# Ralphy Progress Log

- [✗] 2026-01-31 18:36 - Initialize Next.js 16 project with TypeScript, Tailwind CSS, and App Router using pnpm in the current directory
- [✓] 2026-01-31 18:41 - Set up project structure: `src/app`, `src/components`, `src/lib`, `src/lib/adapters`, `src/lib/csv`, `src/types`
- [✓] 2026-01-31 18:42 - Define core TypeScript types and interfaces from PRD spec: `ChainAdapter`, `Transaction`, `PerpTransaction`, `FetchOptions` (see docs/prd.md Section 6)
- [✓] 2026-01-31 18:44 - Create the `ChainAdapterRegistry` that maps chain IDs to their adapter implementations
- [✓] 2026-01-31 18:46 - Set up a shared constants file for Awaken CSV column headers (standard and perpetuals formats from Appendix A)
- [✓] 2026-01-31 18:49 - Implement the standard Awaken CSV generator that takes `Transaction[]` and outputs a compliant CSV string (date format `MM/DD/YYYY HH:MM:SS` UTC, no negative numbers, max 8 decimal places)
- [✓] 2026-01-31 18:51 - Implement multi-asset CSV support with numbered column suffixes (`Received Quantity 1`, `Received Currency 1`, etc.) for LP add/remove transactions
- [✓] 2026-01-31 18:54 - Implement the perpetuals Awaken CSV generator that takes `PerpTransaction[]` and outputs a compliant perps CSV string (supports negative P&L, tags: `open_position`, `close_position`, `funding_payment`)
- [✓] 2026-01-31 18:56 - Write unit tests for both CSV generators using the example rows from Appendix B of docs/prd.md
- [✓] 2026-01-31 18:58 - Implement CSV file download utility with naming convention `awakenfetch_{chain}_{address_short}_{date}.csv`
- [✓] 2026-01-31 19:03 - Implement the Bittensor (TAO) chain adapter using the Taostats API: fetch all transaction types (transfers, staking, delegation, subnet registration), map to `Transaction` interface, implement address validation (ss58 format), and return explorer URL for tx hashes
- [✓] 2026-01-31 19:07 - Implement the Kaspa (KAS) chain adapter using the Kaspa Explorer API: fetch transfers, map to `Transaction` interface, implement address validation, and return explorer URL for tx hashes
- [✓] 2026-01-31 19:14 - Implement the Injective (INJ) chain adapter using the Injective Explorer API / LCD endpoints: fetch transfers and DeFi interactions (swaps, staking), map to `Transaction` interface, implement address validation, and return explorer URL for tx hashes
- [✓] 2026-01-31 19:18 - Add pagination, rate limit handling (exponential backoff, max 3 retries), and cursor-based fetching to all adapters
- [✓] 2026-01-31 19:21 - If any chain API has CORS issues, create a Next.js API route proxy for those specific chains
- [✓] 2026-01-31 19:24 - Build the main page layout with a wallet address text input and chain selector dropdown (only show chains with working adapters)
- [✓] 2026-01-31 19:30 - Implement client-side address format validation per chain (ss58 for Bittensor/Polkadot, bech32 for Kaspa, Injective-specific format) with inline error messages
- [✓] 2026-01-31 19:34 - Add a question mark tooltip next to the chain selector that opens a help modal explaining how to find your wallet address for each chain
- [✓] 2026-01-31 19:37 - Implement the fetch flow: on submit, call the selected chain adapter's `fetchTransactions()`, show a progress indicator with transaction count, handle errors with non-blocking warnings and automatic retry
- [✓] 2026-01-31 19:43 - Build a sortable, filterable, paginated transaction table with columns: Date (UTC), Type, Sent Qty, Sent Currency, Received Qty, Received Currency, Fee, Fee Currency, Tx Hash (hyperlinked to chain explorer), Notes
- [✓] 2026-01-31 19:44 - Implement column sorting (click header to toggle asc/desc) and pagination (50 rows per page)
- [✓] 2026-01-31 19:48 - Add date range filter with a date picker defaulting to previous calendar year (Jan 1 - Dec 31) plus custom range support
- [✓] 2026-01-31 19:53 - Add transaction type filter dropdown
- [✓] 2026-01-31 19:57 - Highlight ambiguous transactions (type = "other") with a yellow background, add a "Needs Review" filter, and make the Type column an editable dropdown for those rows so users can reclassify before export
- [✓] 2026-01-31 19:59 - Add loading/skeleton states while transactions are being fetched
- [✓] 2026-01-31 20:02 - Add a "Download CSV" button that generates and downloads the standard Awaken CSV for all transactions in the current filtered view
- [✓] 2026-01-31 20:06 - Add a separate "Download Perps CSV" button/toggle for perpetuals format export (visible only when a perps-capable chain/protocol is selected)
- [✓] 2026-01-31 20:10 - Implement duplicate export warning: if the user re-exports the same address + date range, show a warning that importing again may create duplicates in Awaken
- [✓] 2026-01-31 20:11 - Store export history in localStorage to power the duplicate detection
- [✓] 2026-01-31 22:22 - Implement MultiversX (EGLD) chain adapter using the MultiversX API
- [✓] 2026-01-31 22:27 - Implement Hedera (HBAR) chain adapter using the Hedera Mirror Node API
- [✓] 2026-01-31 22:32 - Implement Radix (XRD) chain adapter using the Radix Gateway API
- [✓] 2026-01-31 22:37 - Implement Ergo (ERG) chain adapter using the Ergo Explorer API
- [✓] 2026-01-31 22:42 - Implement Polkadot (DOT) chain adapter using the Subscan API (focus on staking and parachain transactions)
- [✓] 2026-01-31 22:48 - Implement Osmosis (OSMO) chain adapter using Mintscan API / LCD endpoints (focus on LP and IBC transactions)
- [✓] 2026-01-31 22:53 - Implement Ronin (RON) chain adapter using SkyMavis API
- [✓] 2026-01-31 22:59 - Implement Variational perpetuals adapter (Arbitrum): fetch open/close/funding transactions, map to `PerpTransaction` interface
- [✓] 2026-01-31 23:05 - Implement Extended perpetuals adapter (StarkNet): fetch open/close/funding transactions, map to `PerpTransaction` interface
- [✓] 2026-01-31 23:08 - Cache fetched transaction data in localStorage so re-exports don't re-fetch
- [✓] 2026-01-31 23:20 - Implement incremental streaming for wallets with > 5,000 transactions (results appear as they load)
- [✓] 2026-01-31 23:21 - Add Content Security Policy headers to restrict script sources
- [✓] 2026-01-31 23:27 - Final pass: ensure all CSV outputs pass Awaken's import validation (test with real wallets on each supported chain)
- [✓] 2026-02-01 03:13 - Fix Injective (INJ) adapter: the Cosmos LCD query returns error `{"code":13,"message":"query cannot be empty"}`. The events query parameter is not being URL-encoded or formatted correctly. The correct endpoint format is `https://sentry.lcd.injective.network/cosmos/tx/v1beta1/txs?events=message.sender%3D%27<address>%27&pagination.limit=50&order_by=ORDER_BY_DESC`. Also make sure this chain goes through the Next.js API proxy at `/api/proxy/[chain]` since LCD endpoints may have CORS issues. Test with address: `inj1qy09gsfx3gxqjahumq97elwxqf4qu5agdmqgnz`
- [✓] 2026-02-01 03:15 - Fix Osmosis (OSMO) adapter: Cosmos LCD endpoints have CORS restrictions and cannot be called from the browser. Add "osmosis" to the PROXY_ENABLED_CHAINS set in `src/app/api/proxy/[chain]/route.ts` so requests go through the Next.js server-side proxy. Also verify the LCD query format works (same issue as Injective -- events query must not be empty). Test with address: `osmo1clpqr4nrk4khgkxj78fcwwh6dl3uw4ep88n0y4`
- [✓] 2026-02-01 03:17 - Fix Ergo (ERG) adapter: the Ergo Explorer API at `https://api.ergoplatform.com` blocks CORS from browser requests. Add "ergo" to the PROXY_ENABLED_CHAINS set in `src/app/api/proxy/[chain]/route.ts` so requests go through the Next.js server-side proxy. Test with address: `9f4QF8AD1nQ3nJahQVkMj8hFSVVzVom77b52JU7EW71Zexg6N8q`
- [✓] 2026-02-01 03:22 - Fix Ronin (RON) adapter: the SkyMavis API endpoint returns 404. The adapter is likely using an outdated or wrong API URL. Research the current working Ronin Explorer API (try `https://explorer-kintsugi.roninchain.com/api` or the Ronin Blockscout API). Add "ronin" to the PROXY_ENABLED_CHAINS set in `src/app/api/proxy/[chain]/route.ts` if needed for CORS. Test with address: `0xa8754b9fa15fc18bb59458815510e40a12cd2014`
- [✓] 2026-02-01 03:31 - Fix Radix (XRD) adapter: the Radix Gateway API rejects the address with a bech32m validation error. The address format `account_rdx1...` is correct but the API call body or endpoint is wrong. Research the correct Radix Gateway API v2 endpoint for fetching account transactions (likely `https://mainnet.radixdlt.com/stream/transactions` with `affected_global_entities_filter`). Test with a valid Radix mainnet address.
- [✓] 2026-02-01 03:33 - Fix Extended (StarkNet) adapter: the Voyager and StarkScan APIs block CORS from browser requests. Add "extended" to the PROXY_ENABLED_CHAINS set in `src/app/api/proxy/[chain]/route.ts` so requests go through the Next.js server-side proxy. Test with address: `0x04718f5a0fc34cc1af16a1cdee98ffb20c31f5cd61d6ab07201858f4287c938d`
